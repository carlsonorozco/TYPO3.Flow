#                                                                        #
# Security policy for the TYPO3 Flow Framework                           #
#                                                                        #
# This file contains the default security policy configuration for the   #
# TYPO3 Flow Framework. Don't modify this file but add configuration     #
# options to the Policy.yaml file in the in global Configuration/        #
# directory instead.                                                     #

privilegeTargets:

  'TYPO3\Flow\Security\Authorization\Privilege\Method\MethodPrivilege':

    'TYPO3.Flow:Tests.RestrictedController.customerAction':
      matcher: 'method(TYPO3\Flow\Tests\Functional\Security\Fixtures\Controller\RestrictedController->customerAction())'

    'TYPO3.Flow:Tests.RestrictedController.adminAction':
      matcher: 'method(TYPO3\Flow\Tests\Functional\Security\Fixtures\Controller\RestrictedController->adminAction())'

roles:

  'TYPO3.Flow:Customer':
    privileges:
      -
        privilegeTarget: 'TYPO3.Flow:Tests.RestrictedController.customerAction'
        permission: GRANT
      -
        privilegeTarget: 'TYPO3.Flow:Tests.RestrictedController.adminAction'
        permission: DENY

  'TYPO3.Flow:Administrator':
    privileges:
      -
        privilegeTarget: 'TYPO3.Flow:Tests.RestrictedController.customerAction'
        permission: GRANT
      -
        privilegeTarget: 'TYPO3.Flow:Tests.RestrictedController.adminAction'
        permission: GRANT